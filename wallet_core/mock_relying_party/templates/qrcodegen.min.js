!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).qrcodegen={})}(this,(function(e){"use strict";const t="undefined"!=typeof WebAssembly?WebAssembly:"undefined"!=typeof WXWebAssembly?WXWebAssembly:void 0;if(!t)throw new Error("WebAssembly is not supported in this environment");function n(e,n){return"undefined"!=typeof wx&&"undefined"!=typeof __wxConfig?t.instantiate(e,n):fetch(e).then((e=>e.arrayBuffer())).then((e=>t.instantiate(e,n)))}function r(e,r){let o;if(function(e){if(e&&"object"!=typeof e)throw new TypeError("imports must be an object or undefined")}(r),r=null!=r?r:{},e instanceof ArrayBuffer||ArrayBuffer.isView(e))return t.instantiate(e,r);if("string"!=typeof e&&!(e instanceof URL))throw new TypeError("Invalid source");if("function"==typeof t.instantiateStreaming){let i;try{i=fetch(e),o=t.instantiateStreaming(i,r).catch((()=>n(e,r)))}catch(t){o=n(e,r)}}else o=n(e,r);return o}var o,i,f,c=function(){function e(e){this._instance=e,this._pointers=[]}return e.prototype.malloc=function(e){var t=this._instance.exports.malloc(e);if(0===t)throw new Error("OOM");return this._pointers.push({pointer:t,size:e}),t},e.prototype.dispose=function(){if(this._pointers){var e=this._pointers;this._pointers=void 0;for(var t=0;t<e.length;++t){var n=e[t];this._instance.exports.free(n.pointer)}}},e.run=function(t,n){var r,o=new e(t);try{r=n(o)}catch(e){throw o.dispose(),e}return o.dispose(),r},e}(),a=function(e){return Math.floor(((4*e+17)*(4*e+17)+7)/8)+1},s=null!==(o="undefined"!=typeof document&&document.currentScript&&document.currentScript.src)&&void 0!==o?o:"";e.Ecc=void 0,(f=e.Ecc||(e.Ecc={}))[f.LOW=0]="LOW",f[f.MEDIUM=1]="MEDIUM",f[f.QUARTILE=2]="QUARTILE",f[f.HIGH=3]="HIGH",e.drawCanvas=function(e,t,n){var r,o,i,f,c=t.length,a=e.width,s=null!==(r=e.height)&&void 0!==r?r:a,u=e.getContext("2d"),l=null!==(o=(n=null!=n?n:{}).padding)&&void 0!==o?o:0;u.save();try{u.fillStyle=null!==(i=n.backgroundColor)&&void 0!==i?i:"#ffffff",u.fillRect(0,0,a,s);var d=(a-2*l)/c,h=(s-2*l)/c,p=-1,y=-1;u.fillStyle=null!==(f=n.foregroundColor)&&void 0!==f?f:"#000000";for(var v=0;v<c;++v){for(var g=0;g<c;++g){t[v][g]?(-1!==p||(p=g),y=g+1):-1!==p&&(u.fillRect(l+p*d,Math.floor(l+v*h),d*(y-p),Math.ceil(h)),p=-1,y=-1)}-1!==p&&(u.fillRect(l+p*d,Math.floor(l+v*h),d*(y-p),Math.ceil(h)),p=-1,y=-1)}}catch(e){throw u.restore(),e}u.restore()},e.init=function(t){if(i)return i;var n,o=function(t){var n=t.instance;return"function"==typeof n.exports._initialize&&n.exports._initialize(),function(t){var n=function(e){for(var n=t.exports.qrcodegen_getSize(e),r=Array.from({length:n},(function(){return Array(n)})),o=0;o<n;++o)for(var i=0;i<n;++i)r[o][i]=t.exports.qrcodegen_getModule(e,i,o);return r},r=function(r,o){return void 0===o&&(o=e.Ecc.LOW),c.run(t,(function(e){var i,f=new Uint8Array(t.exports.memory.buffer);if("function"==typeof TextEncoder){var c=(new TextEncoder).encode(r);i=e.malloc(c.byteLength+1),f.set(c,i),f[i+c.byteLength]=0}else{var s=function(e){for(var t=0,n=0;n<e.length;++n){var r=e.charCodeAt(n);r<=127?t++:r<=2047?t+=2:r>=55296&&r<=57343?(t+=4,++n):t+=3}return t}(r)+1;i=e.malloc(s),function(e,t,n,r){if(!(r>0))return 0;for(var o=n,i=n+r-1,f=0;f<e.length;++f){var c=e.charCodeAt(f);if(c>=55296&&c<=57343)c=65536+((1023&c)<<10)|1023&e.charCodeAt(++f);if(c<=127){if(n>=i)break;t[n++]=c}else if(c<=2047){if(n+1>=i)break;t[n++]=192|c>>6,t[n++]=128|63&c}else if(c<=65535){if(n+2>=i)break;t[n++]=224|c>>12,t[n++]=128|c>>6&63,t[n++]=128|63&c}else{if(n+3>=i)break;t[n++]=240|c>>18,t[n++]=128|c>>12&63,t[n++]=128|c>>6&63,t[n++]=128|63&c}}t[n]=0}(r,f,i,s)}var u=a(40),l=e.malloc(u),d=e.malloc(u);if(!t.exports.qrcodegen_encodeText(i,d,l,o,1,40,-1,1))throw new Error("encoding failed");return n(l)}))},o=function(r,o){return void 0===o&&(o=e.Ecc.LOW),c.run(t,(function(e){var i=r instanceof ArrayBuffer?new Uint8Array(r):new Uint8Array(r.buffer,r.byteOffset,r.byteLength),f=new Uint8Array(t.exports.memory.buffer),c=a(40);if(i.byteLength>c)throw new Error("data is too big");var s=e.malloc(c),u=e.malloc(c);if(f.set(i,u),!t.exports.qrcodegen_encodeBinary(u,i.byteLength,s,o,1,40,-1,1))throw new Error("encoding failed");return n(s)}))};return{encodeText:r,encodeBinary:o}}(n)},f=function(e){throw i=void 0,e};return t?i=r(t).then(o,f):(n=s?s.substring(0,s.lastIndexOf("/"))+"/qrcodegen.wasm":"./qrcodegen.wasm",i=r(n).then(o,f))},Object.defineProperty(e,"__esModule",{value:!0})}));
