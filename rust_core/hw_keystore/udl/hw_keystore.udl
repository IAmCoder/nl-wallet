[Error]
interface KeyStoreError {
    KeyError(string? message);
    InternalError(string message);
};

callback interface KeyStoreBridge {
    [Throws=KeyStoreError]
    AsymmetricKeyBridge get_or_create_key(string identifier);
};

callback interface AsymmetricKeyBridge {
    [Throws=KeyStoreError]
    sequence<u8> public_key();

    [Throws=KeyStoreError]
    sequence<u8> sign(sequence<u8> payload);
};

namespace hw_keystore {
    void init_hw_keystore(KeyStoreBridge bridge);
};
